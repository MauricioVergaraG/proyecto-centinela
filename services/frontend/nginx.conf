# Configuración simple de Nginx para una SPA (Single Page Application)
server {
  listen 80;
  server_name  localhost;

  # Ruta raíz donde están tus archivos (ej. index.html)
  root   /usr/share/nginx/html;
  index  index.html index.htm;

  # --- ¡AQUÍ ESTÁ LA REMEDIACIÓN DE DAST! ---

  # 1. Arregla: "Missing Anti-clickjacking Header"
  add_header X-Frame-Options "SAMEORIGIN";

  # 2. Arregla: "X-Content-Type-Options Header Missing"
  add_header X-Content-Type-Options "nosniff";

  # 3. Arregla: "Server Leaks Version Information"
  server_tokens off;

  # 4. Arregla: "Content Security Policy (CSP) Header Not Set"
  #    Esta es una política BÁSICA. En un proyecto real, sería más estricta.
  add_header Content-Security-Policy "default-src 'self'; script-src 'self'; object-src 'none';";

  # 5. Arregla: "Permissions Policy Header Not Set"
  add_header Permissions-Policy "camera=(), microphone=(), geolocation=()";

  # --- FIN DE LA REMEDIACIÓN ---

  # Esta regla asegura que si el usuario refresca la página (ej. /pagina2),
  # React/Vue maneje la ruta en lugar de Nginx.
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Configuración para los archivos estáticos (JS, CSS, etc.)
  location ~ \.(css|js|png|jpg|gif|ico)$ {
    expires 1d; # Cache de 1 día
  }
}
